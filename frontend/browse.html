<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Browse - Sugar Dating</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <h2>Browse Sugar Profiles</h2>
  <div id="profiles"></div>
  <button onclick="logout()">Logout</button>
</div>

<script>
const token = localStorage.getItem("token");

async function loadProfiles() {
  if (!token) {
    window.location.href = "login.html";
    return;
  }

  try {
    const res = await fetch("https://sugar-dating-site.onrender.com/api/users", {
      headers: { "Authorization": `Bearer ${token}` }
    });
    const data = await res.json();
    const container = document.getElementById("profiles");

    if (data.error) {
      container.innerHTML = `<p>${data.error}</p>`;
      return;
    }

    container.innerHTML = data.map(user => `
      <div class="profile-card">
        <h3>${user.name} (${user.role})</h3>
        <p>Email: ${user.email}</p>
        <p>DOB: ${user.dateOfBirth}</p>
      </div>
    `).join("");

  } catch (err) {
    document.getElementById("profiles").innerHTML = "<p>Network error. Try again.</p>";
  }
}

function logout() {
  localStorage.removeItem("token");
  localStorage.removeItem("user");
  window.location.href = "login.html";
}

window.onload = loadProfiles;
</script>
</body>
</html>
